{% extends 'layout.html' %}

{% block body %}
<script>
        async function fetchWeather(location){
            try{
                const response = await fetch(`api/${location}`);
                const data = await response.json();
                if (!response.ok) {
                    console.error(`Error: ${response.status} ${response.statusText}`);
                }
                console.log('Forecast:', data.forecast, 'Hourly:', data.hourly);
            } catch(error){
                console.error('There was a problem fetching data:', error);
            }
        }

        async function updateLocation(location){
            try{
                const response = await fetch(`/update/${location}`);
                const data = await response.json();

                if (!response.ok) {
                    console.error(`Error: ${response.status} ${response.statusText}`);
                    return;
                }

                console.log(`${location} updated`)
                let updatedWeather = data.updated_data
                updatedWeather.forEach(location => {
                    let wind_symbol = document.querySelector(`.wind-symbol_${location.id}`);
                    let wind_deg = location.wind_deg;
                    if (wind_symbol){
                        let svg = '';
                        if (wind_deg >= 0 && wind_deg <= 22.5){
                            svg = '<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M440-80v-647L256-544l-56-56 280-280 280 280-56 57-184-184v647h-80Z"/></svg>';
                        }
                        else if (wind_deg >= 22.6 && wind_deg <= 67.5){
                            svg = '<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="m216-160-56-56 464-464H360v-80h400v400h-80v-264L216-160Z"/></svg>';
                        }
                        else if (wind_deg >= 67.6 && wind_deg <= 112.5){
                            svg = '<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="m600-200-57-56 184-184H80v-80h647L544-704l56-56 280 280-280 280Z"/></svg>';
                        }
                        else if (wind_deg >= 112.6 && wind_deg <= 157.5){
                            svg = '<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M360-200v-80h264L160-744l56-56 464 464v-264h80v400H360Z"/></svg>';
                        }
                        else if (wind_deg >= 157.6 && wind_deg <= 202.5){
                            svg = '<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M480-80 200-360l56-56 184 183v-647h80v647l184-184 56 57L480-80Z"/></svg>';
                        }
                        else if (wind_deg >= 202.6 && wind_deg <= 247.5){
                            svg = '<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M200-200v-400h80v264l464-464 56 56-464 464h264v80H200Z"/></svg>';
                        }
                        else if (wind_deg >= 247.6 && wind_deg <= 292.5){
                            svg = '<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M360-200 80-480l280-280 56 56-183 184h647v80H233l184 184-57 56Z"/></svg>';
                        }
                        else if (wind_deg >= 292.6 && wind_deg <= 337.5){
                            svg = '<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M744-160 280-624v264h-80v-400h400v80H336l464 464-56 56Z"/></svg>';
                        }
                        else if (wind_deg >= 337.6 && wind_deg <= 360){
                            svg = '<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M440-80v-647L256-544l-56-56 280-280 280 280-56 57-184-184v647h-80Z"/></svg>';
                        }
                        else {
                            svg = '<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M440-80v-647L256-544l-56-56 280-280 280 280-56 57-184-184v647h-80Z"/></svg>';
                        }

                        let currentBlock = document.getElementById(`block_${location.id}`);
                        if(currentBlock) {
                            currentBlock.innerHTML = `
                                <div class="all-current">
                                    <span class="location-name">${ location.city }</span>
                                    <div data-bs-toggle="modal" data-bs-target="#modal_${location.id}" class="current-weather">
                                        <div class="icon-div">
                                            <img data-city="${ location.city }"class="big-icon" src="http://openweathermap.org/img/wn/${ location.icon }.png" alt="Weather Icon">
                                        </div>
                                        <div class="temp-div">
                                            <p class="big-temp"><b>${ location.temperature }</b></p>
                                            <p class="degree">째F</p>
                                        </div>
                                    </div>
                                        <p class="big-desc">${ location.weather_description }</p>
                                </div>
                                <div id="modal_${location.id}" class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
                                    <div class="modal-dialog modal-dialog-centered modal-lg">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title">Current Weather</h5>
                                        </div>
                                        <div class="modal-body">
                                            <div class="modal-upper">
                                                <div class="pic-div">
                                                    <img id="modal-icon" src="https://openweathermap.org/img/wn/${ location.icon }@2x.png" alt="Weather Icon">
                                                </div>
                                                <div class="temps_div">
                                                    <div class="reg-temp">
                                                        <span class="temp-reg">${ location.temperature }째</span>
                                                    </div>
                                                    <div class="temp-extremes">
                                                        <span class="temp_max">H:${ location.tempmax }째</span>
                                                        <span class="temp_min">L:${ location.tempmin }째</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="modal-elements">
                                                <div class="modal-element">
                                                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="gray"><path d="M295-119q-36-1-68.5-18.5T165-189q-40-48-62.5-114.5T80-440q0-83 31.5-156T197-723q54-54 127-85.5T480-840q83 0 156 32t127 87q54 55 85.5 129T880-433q0 77-25 144t-71 113q-28 28-59 42.5T662-119q-18 0-36-4.5T590-137l-56-28q-12-6-25.5-9t-28.5-3q-15 0-28.5 3t-25.5 9l-56 28q-19 10-37.5 14.5T295-119Zm2-80q9 0 18.5-2t18.5-7l56-28q21-11 43.5-16t45.5-5q23 0 46 5t44 16l57 28q9 5 18 7t18 2q19 0 36-10t34-30q32-38 50-91t18-109q0-134-93-227.5T480-760q-134 0-227 94t-93 228q0 57 18.5 111t51.5 91q17 20 33 28.5t34 8.5Zm183-281Zm0 120q33 0 56.5-23.5T560-440q0-8-1.5-16t-4.5-16l50-67q10 13 17.5 27.5T634-480h82q-15-88-81.5-144T480-680q-88 0-155 56.5T244-480h82q14-54 57-87t97-33q17 0 32 3t29 9l-51 69q-2 0-5-.5t-5-.5q-33 0-56.5 23.5T400-440q0 33 23.5 56.5T480-360Z"/></svg>
                                                        <p class="element-title">PRESSURE</p>
                                                        <p class="element-unit">${ location.pressure } inHg</p>
                                                    </div>
                                                    <div class="modal-element">
                                                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="gray"><path d="M580-240q25 0 42.5-17.5T640-300q0-25-17.5-42.5T580-360q-25 0-42.5 17.5T520-300q0 25 17.5 42.5T580-240Zm-202-2 260-260-56-56-260 260 56 56Zm2-198q25 0 42.5-17.5T440-500q0-25-17.5-42.5T380-560q-25 0-42.5 17.5T320-500q0 25 17.5 42.5T380-440ZM480-80q-137 0-228.5-94T160-408q0-100 79.5-217.5T480-880q161 137 240.5 254.5T800-408q0 140-91.5 234T480-80Zm0-80q104 0 172-70.5T720-408q0-73-60.5-165T480-774Q361-665 300.5-573T240-408q0 107 68 177.5T480-160Zm0-320Z"/></svg>
                                                        <p class="element-title">HUMIDITY</p>
                                                        <p class="element-unit">${ location.humidity } %</p>
                                                    </div>
                                                    <div class="modal-element">
                                                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="gray"><path d="M480-80q-83 0-141.5-58.5T280-280q0-48 21-89.5t59-70.5v-320q0-50 35-85t85-35q50 0 85 35t35 85v320q38 29 59 70.5t21 89.5q0 83-58.5 141.5T480-80Zm-40-440h80v-40h-40v-40h40v-80h-40v-40h40v-40q0-17-11.5-28.5T480-800q-17 0-28.5 11.5T440-760v240Z"/></svg>
                                                        <p class="element-title">FEELS LIKE</p>
                                                        <p class="element-unit">${ location.feels_like }째</p>
                                                    </div>
                                                    <div class="modal-element">
                                                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="gray"><path d="M558-84q-15 8-30.5 2.5T504-102l-60-120q-8-15-2.5-30.5T462-276q15-8 30.5-2.5T516-258l60 120q8 15 2.5 30.5T558-84Zm240 0q-15 8-30.5 2.5T744-102l-60-120q-8-15-2.5-30.5T702-276q15-8 30.5-2.5T756-258l60 120q8 15 2.5 30.5T798-84Zm-480 0q-15 8-30.5 2.5T264-102l-60-120q-8-15-2.5-30.5T222-276q15-8 30.5-2.5T276-258l60 120q8 15 2.5 30.5T318-84Zm-18-236q-91 0-155.5-64.5T80-540q0-83 55-145t136-73q32-57 87.5-89.5T480-880q90 0 156.5 57.5T717-679q69 6 116 57t47 122q0 75-52.5 127.5T700-320H300Zm0-80h400q42 0 71-29t29-71q0-42-29-71t-71-29h-60v-40q0-66-47-113t-113-47q-48 0-87.5 26T333-704l-10 24h-25q-57 2-97.5 42.5T160-540q0 58 41 99t99 41Zm180-200Z"/></svg>
                                                        <p class="element-title">RAINFALL</p>
                                                        <p class="element-unit">${ location.rainfall } mm</p>
                                                    </div>
                                                    <div class="modal-element">
                                                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="gray"><path d="M480-360q50 0 85-35t35-85q0-50-35-85t-85-35q-50 0-85 35t-35 85q0 50 35 85t85 35Zm0 80q-83 0-141.5-58.5T280-480q0-83 58.5-141.5T480-680q83 0 141.5 58.5T680-480q0 83-58.5 141.5T480-280ZM200-440H40v-80h160v80Zm720 0H760v-80h160v80ZM440-760v-160h80v160h-80Zm0 720v-160h80v160h-80ZM256-650l-101-97 57-59 96 100-52 56Zm492 496-97-101 53-55 101 97-57 59Zm-98-550 97-101 59 57-100 96-56-52ZM154-212l101-97 55 53-97 101-59-57Zm326-268Z"/></svg>
                                                        <p class="element-title">SUNRISE</p>
                                                        <p class="element-unit">${ location.sunrise } am</p>
                                                    </div>
                                                    <div class="modal-element">
                                                       <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="gray"><path d="M480-120q-150 0-255-105T120-480q0-150 105-255t255-105q14 0 27.5 1t26.5 3q-41 29-65.5 75.5T444-660q0 90 63 153t153 63q55 0 101-24.5t75-65.5q2 13 3 26.5t1 27.5q0 150-105 255T480-120Zm0-80q88 0 158-48.5T740-375q-20 5-40 8t-40 3q-123 0-209.5-86.5T364-660q0-20 3-40t8-40q-78 32-126.5 102T200-480q0 116 82 198t198 82Zm-10-270Z"/></svg>
                                                        <p class="element-title">SUNSET</p>
                                                        <p class="element-unit">${ location.sunset } pm</p>
                                                    </div>
                                                    <div class="modal-element">
                                                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="gray"><path d="M460-160q-50 0-85-35t-35-85h80q0 17 11.5 28.5T460-240q17 0 28.5-11.5T500-280q0-17-11.5-28.5T460-320H80v-80h380q50 0 85 35t35 85q0 50-35 85t-85 35ZM80-560v-80h540q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43h-80q0-59 40.5-99.5T620-840q59 0 99.5 40.5T760-700q0 59-40.5 99.5T620-560H80Zm660 320v-80q26 0 43-17t17-43q0-26-17-43t-43-17H80v-80h660q59 0 99.5 40.5T880-380q0 59-40.5 99.5T740-240Z"/></svg>
                                                        <p class="element-title">WIND</p>
                                                        <div class="wind-div">
                                                                <span id="wind_symbol" class="wind-symbol_${location.id}">${svg}</span>
                                                                <p class="element-unit" id="wind_speed">${ location.wind_speed } mph</p>
                                                        </div>
                                                    </div>
                                                    <div class="modal-element">
                                                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="gray"><path d="M260-160q-91 0-155.5-63T40-377q0-78 47-139t123-78q25-92 100-149t170-57q117 0 198.5 81.5T760-520q69 8 114.5 59.5T920-340q0 75-52.5 127.5T740-160H260Zm0-80h480q42 0 71-29t29-71q0-42-29-71t-71-29h-60v-80q0-83-58.5-141.5T480-720q-83 0-141.5 58.5T280-520h-20q-58 0-99 41t-41 99q0 58 41 99t99 41Zm220-240Z"/></svg>
                                                        <p class="element-title">VISIBILITY</p>
                                                        <p class="element-unit">${ location.visibility } mi</p>
                                                    </div>

                                            </div>
                                            <div class="daily-summary">
                                                <p class='daily-header'>Daily Summary</p>
                                                <div class="daily-description">
                                                    <p class="daily-desc"><span></span>The current weather is <span>${location.temperature }째.</span> and feels like <span>${location.feels_like }째</span> There is  <span>${location.weather_description} with ${location.rainfall}mm of rain in the past hour.</span></p>
                                                </div>
                                            </div>
                                            <div class="updated-time">
                                                <p><small>Last updated at ${ location.time }</small></p>
                                            </div>
                                        </div>
                                    </div>
                                    </div>
                                </div>`;
                        }
                    }
                });
                
            } catch(error){
                console.error('There was a problem fetching data:', error);
            }
        }

         
    document.addEventListener("DOMContentLoaded", async function() {  
        const spinner = document.querySelector('.spinner-border');
        const locationBody = document.querySelector('.locationDiv');
        const location = document.querySelector('.big-icon').getAttribute('data-city');
        try {
            await updateLocation(location);
            console.log('Data successfully loaded');
        } catch (error) {
            console.error('Error loading data:', error);
        } finally {
            spinner.style.display = 'none';
            locationBody.style.visibility = "visible";
        }    
        const hideElements = (selector) => {
            document.querySelectorAll(selector).forEach(element => {
                element.style.display = 'none';
            });
        };
        const showElements = (selector) => {
            document.querySelectorAll(selector).forEach(element => {
                element.style.display = 'block';
            });
        };

        const tempTab = document.querySelector('#tempLink');
        const popTab = document.querySelector('#popLink');
        const windTab = document.querySelector('#windLink');

   
        hideElements('.rainPic');
        hideElements('.windPic');
        hideElements('.hourPop');
        hideElements('.hourWind');

        // Show weatherPic and hourTemp initially
        showElements('.weatherPic');
        showElements('.hourTemp');

        const removeActiveClasses = () => {
            tempTab.classList.remove('active');
            popTab.classList.remove('active');
            windTab.classList.remove('active');
        };

        tempTab.addEventListener('click', function(){
            showElements('.weatherPic');
            showElements('.hourTemp');
            hideElements('.rainPic');
            hideElements('.hourPop');
            hideElements('.windPic');
            hideElements('.hourWind');
            removeActiveClasses();
            tempTab.classList.add('nav-link', 'active');

        });
        popTab.addEventListener('click', function(){
            showElements('.rainPic');
            showElements('.hourPop');
            hideElements('.weatherPic');
            hideElements('.hourTemp');
            hideElements('.windPic');
            hideElements('.hourWind');
            removeActiveClasses();
            popTab.classList.add('nav-link', 'active');

        });
        windTab.addEventListener('click', function(){
            showElements('.windPic');
            showElements('.hourWind');
            hideElements('.rainPic');
            hideElements('.hourPop');
            hideElements('.weatherPic');
            hideElements('.hourTemp');
            removeActiveClasses();
            windTab.classList.add('nav-link', 'active');
        });
        fetchWeather(location);
    });
</script>
<div class="spinner-container">
    <div class="spinner-border" role="status">
        <span class="sr-only"></span>
    </div>
</div>
<div class="locationDiv">
        {% for loc in location %}
        <div id="block_{{ loc.id }}" class="current-block">
                <div class="all-current">
                    <span class="location-name">{{ loc.city }}</span>
                    <div data-bs-toggle="modal" data-bs-target="#modal_{{loc.id}}" class="current-weather">
                        <div class="icon-div">
                            <img data-city="{{ loc.city }}"class="big-icon" src="http://openweathermap.org/img/wn/{{ loc.icon }}.png" alt="Weather Icon">
                        </div>
                        <div class="temp-div">
                            <p class="big-temp"><b>{{ loc.temperature }}</b></p>
                            <p class="degree">째F</p>
                        </div>
                    </div>
                        <p class="big-desc">{{ loc.weather_description }}</p>
                </div>
                <div id="modal_{{loc.id}}" class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Current Weather</h5>
                        </div>
                        <div class="modal-body">
                            <div class="modal-upper">
                                <div class="pic-div">
                                    <img id="modal-icon" src="https://openweathermap.org/img/wn/{{ loc.icon }}@2x.png" alt="Weather Icon">
                                </div>
                                <div class="temps_div">
                                    <div class="reg-temp">
                                        <span class="temp-reg">{{ loc.temperature }}째</span>
                                    </div>
                                    <div class="temp-extremes">
                                        <span class="temp_max">H:{{ loc.tempmax }}째</span>
                                        <span class="temp_min">L:{{ loc.tempmin }}째</span>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-elements">
                                    <div class="modal-element">
                                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="gray"><path d="M295-119q-36-1-68.5-18.5T165-189q-40-48-62.5-114.5T80-440q0-83 31.5-156T197-723q54-54 127-85.5T480-840q83 0 156 32t127 87q54 55 85.5 129T880-433q0 77-25 144t-71 113q-28 28-59 42.5T662-119q-18 0-36-4.5T590-137l-56-28q-12-6-25.5-9t-28.5-3q-15 0-28.5 3t-25.5 9l-56 28q-19 10-37.5 14.5T295-119Zm2-80q9 0 18.5-2t18.5-7l56-28q21-11 43.5-16t45.5-5q23 0 46 5t44 16l57 28q9 5 18 7t18 2q19 0 36-10t34-30q32-38 50-91t18-109q0-134-93-227.5T480-760q-134 0-227 94t-93 228q0 57 18.5 111t51.5 91q17 20 33 28.5t34 8.5Zm183-281Zm0 120q33 0 56.5-23.5T560-440q0-8-1.5-16t-4.5-16l50-67q10 13 17.5 27.5T634-480h82q-15-88-81.5-144T480-680q-88 0-155 56.5T244-480h82q14-54 57-87t97-33q17 0 32 3t29 9l-51 69q-2 0-5-.5t-5-.5q-33 0-56.5 23.5T400-440q0 33 23.5 56.5T480-360Z"/></svg>
                                        <p class="element-title">PRESSURE</p>
                                        <p class="element-unit">{{ loc.pressure }} inHg</p>
                                    </div>
                                    <div class="modal-element">
                                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="gray"><path d="M580-240q25 0 42.5-17.5T640-300q0-25-17.5-42.5T580-360q-25 0-42.5 17.5T520-300q0 25 17.5 42.5T580-240Zm-202-2 260-260-56-56-260 260 56 56Zm2-198q25 0 42.5-17.5T440-500q0-25-17.5-42.5T380-560q-25 0-42.5 17.5T320-500q0 25 17.5 42.5T380-440ZM480-80q-137 0-228.5-94T160-408q0-100 79.5-217.5T480-880q161 137 240.5 254.5T800-408q0 140-91.5 234T480-80Zm0-80q104 0 172-70.5T720-408q0-73-60.5-165T480-774Q361-665 300.5-573T240-408q0 107 68 177.5T480-160Zm0-320Z"/></svg>
                                        <p class="element-title">HUMIDITY</p>
                                        <p class="element-unit">{{ loc.humidity }} %</p>
                                    </div>
                                    <div class="modal-element">
                                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="gray"><path d="M480-80q-83 0-141.5-58.5T280-280q0-48 21-89.5t59-70.5v-320q0-50 35-85t85-35q50 0 85 35t35 85v320q38 29 59 70.5t21 89.5q0 83-58.5 141.5T480-80Zm-40-440h80v-40h-40v-40h40v-80h-40v-40h40v-40q0-17-11.5-28.5T480-800q-17 0-28.5 11.5T440-760v240Z"/></svg>                                    <p class="element-title">FEELS LIKE</p>
                                        <p class="element-unit">{{ loc.feels_like }}째</p>
                                    </div>
                                    <div class="modal-element">
                                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="gray"><path d="M558-84q-15 8-30.5 2.5T504-102l-60-120q-8-15-2.5-30.5T462-276q15-8 30.5-2.5T516-258l60 120q8 15 2.5 30.5T558-84Zm240 0q-15 8-30.5 2.5T744-102l-60-120q-8-15-2.5-30.5T702-276q15-8 30.5-2.5T756-258l60 120q8 15 2.5 30.5T798-84Zm-480 0q-15 8-30.5 2.5T264-102l-60-120q-8-15-2.5-30.5T222-276q15-8 30.5-2.5T276-258l60 120q8 15 2.5 30.5T318-84Zm-18-236q-91 0-155.5-64.5T80-540q0-83 55-145t136-73q32-57 87.5-89.5T480-880q90 0 156.5 57.5T717-679q69 6 116 57t47 122q0 75-52.5 127.5T700-320H300Zm0-80h400q42 0 71-29t29-71q0-42-29-71t-71-29h-60v-40q0-66-47-113t-113-47q-48 0-87.5 26T333-704l-10 24h-25q-57 2-97.5 42.5T160-540q0 58 41 99t99 41Zm180-200Z"/></svg>
                                        <p class="element-title">RAINFALL</p>
                                        <p class="element-unit">{{ loc.rainfall }} mm</p>
                                    </div>
                                    <div class="modal-element">
                                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="gray"><path d="M558-84q-15 8-30.5 2.5T504-102l-60-120q-8-15-2.5-30.5T462-276q15-8 30.5-2.5T516-258l60 120q8 15 2.5 30.5T558-84Zm240 0q-15 8-30.5 2.5T744-102l-60-120q-8-15-2.5-30.5T702-276q15-8 30.5-2.5T756-258l60 120q8 15 2.5 30.5T798-84Zm-480 0q-15 8-30.5 2.5T264-102l-60-120q-8-15-2.5-30.5T222-276q15-8 30.5-2.5T276-258l60 120q8 15 2.5 30.5T318-84Zm-18-236q-91 0-155.5-64.5T80-540q0-83 55-145t136-73q32-57 87.5-89.5T480-880q90 0 156.5 57.5T717-679q69 6 116 57t47 122q0 75-52.5 127.5T700-320H300Zm0-80h400q42 0 71-29t29-71q0-42-29-71t-71-29h-60v-40q0-66-47-113t-113-47q-48 0-87.5 26T333-704l-10 24h-25q-57 2-97.5 42.5T160-540q0 58 41 99t99 41Zm180-200Z"/></svg>
                                        <p class="element-title">SUNRISE</p>
                                        <p class="element-unit">{{ loc.sunrise }} am</p>
                                    </div>
                                    <div class="modal-element">
                                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="gray"><path d="M558-84q-15 8-30.5 2.5T504-102l-60-120q-8-15-2.5-30.5T462-276q15-8 30.5-2.5T516-258l60 120q8 15 2.5 30.5T558-84Zm240 0q-15 8-30.5 2.5T744-102l-60-120q-8-15-2.5-30.5T702-276q15-8 30.5-2.5T756-258l60 120q8 15 2.5 30.5T798-84Zm-480 0q-15 8-30.5 2.5T264-102l-60-120q-8-15-2.5-30.5T222-276q15-8 30.5-2.5T276-258l60 120q8 15 2.5 30.5T318-84Zm-18-236q-91 0-155.5-64.5T80-540q0-83 55-145t136-73q32-57 87.5-89.5T480-880q90 0 156.5 57.5T717-679q69 6 116 57t47 122q0 75-52.5 127.5T700-320H300Zm0-80h400q42 0 71-29t29-71q0-42-29-71t-71-29h-60v-40q0-66-47-113t-113-47q-48 0-87.5 26T333-704l-10 24h-25q-57 2-97.5 42.5T160-540q0 58 41 99t99 41Zm180-200Z"/></svg>
                                        <p class="element-title">SUNSET</p>
                                        <p class="element-unit">{{ loc.sunset }} pm</p>
                                    </div>
                                    <div class="modal-element">
                                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="gray"><path d="M558-84q-15 8-30.5 2.5T504-102l-60-120q-8-15-2.5-30.5T462-276q15-8 30.5-2.5T516-258l60 120q8 15 2.5 30.5T558-84Zm240 0q-15 8-30.5 2.5T744-102l-60-120q-8-15-2.5-30.5T702-276q15-8 30.5-2.5T756-258l60 120q8 15 2.5 30.5T798-84Zm-480 0q-15 8-30.5 2.5T264-102l-60-120q-8-15-2.5-30.5T222-276q15-8 30.5-2.5T276-258l60 120q8 15 2.5 30.5T318-84Zm-18-236q-91 0-155.5-64.5T80-540q0-83 55-145t136-73q32-57 87.5-89.5T480-880q90 0 156.5 57.5T717-679q69 6 116 57t47 122q0 75-52.5 127.5T700-320H300Zm0-80h400q42 0 71-29t29-71q0-42-29-71t-71-29h-60v-40q0-66-47-113t-113-47q-48 0-87.5 26T333-704l-10 24h-25q-57 2-97.5 42.5T160-540q0 58 41 99t99 41Zm180-200Z"/></svg>
                                        <p class="element-title">WIND</p>
                                        <div class="wind-div">
                                            <span id="wind_symbol" class="wind-symbol_{{loc.id}}"></span>
                                            <p class="element-unit" id="wind_speed">{{ loc.wind_speed }} mph</p>
                                        </div>
                                    </div>
                                    <div class="modal-element">
                                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="gray"><path d="M558-84q-15 8-30.5 2.5T504-102l-60-120q-8-15-2.5-30.5T462-276q15-8 30.5-2.5T516-258l60 120q8 15 2.5 30.5T558-84Zm240 0q-15 8-30.5 2.5T744-102l-60-120q-8-15-2.5-30.5T702-276q15-8 30.5-2.5T756-258l60 120q8 15 2.5 30.5T798-84Zm-480 0q-15 8-30.5 2.5T264-102l-60-120q-8-15-2.5-30.5T222-276q15-8 30.5-2.5T276-258l60 120q8 15 2.5 30.5T318-84Zm-18-236q-91 0-155.5-64.5T80-540q0-83 55-145t136-73q32-57 87.5-89.5T480-880q90 0 156.5 57.5T717-679q69 6 116 57t47 122q0 75-52.5 127.5T700-320H300Zm0-80h400q42 0 71-29t29-71q0-42-29-71t-71-29h-60v-40q0-66-47-113t-113-47q-48 0-87.5 26T333-704l-10 24h-25q-57 2-97.5 42.5T160-540q0 58 41 99t99 41Zm180-200Z"/></svg>
                                        <p class="element-title">VISIBILITY</p>
                                        <p class="element-unit">{{ loc.visibility }} mi</p>
                                    </div>
                            </div>
                            <div class="daily-summary">
                                <p class="daily-header">Daily Summary</p>
                                <div class="daily-description">
                                    <p class="daily-desc">The current weather is <span>{{ loc.temperature }}.</span> and feels like <span>{{ loc.feels_like }}째</span> There is  <span>{{loc.weather_description}} with {{loc.rainfall }}mm in the past hour.</span></p>
                                </div>
                            </div>
                            <div class="updated-time">
                            <p><small>Last updated at {{loc.time}}</small></p>
                            </div>
                        </div>
                    </div>
                    </div>
                </div>
        </div>
        {% endfor %}

    
            <ul class="nav nav-underline">
                <li class="nav-item">
                    <a id="tempLink" class="nav-link active">Temperature</a>
                </li>
                <li class="nav-item">
                    <a id="popLink" class="nav-link">Precipitation</a>
                </li>
                <li class="nav-item">
                    <a id="windLink" class="nav-link">Wind</a>
                </li>
            </ul>
            <div class="top-row">
                <div class="top-symbol">
                    <i class="fa-regular fa-clock" style="color: rgba(255, 255, 255, 0.2);"></i>
                </div>
                <div class="top-title">
                    <p class="title-top">HOURLY FORECAST</p>
                </div>
            </div>
            <div class="hourly-block">
                {% if hourly %}
                    {% for hour in hourly %}
                        <div class="hourly-column">
                            <p><b>{{ hour.hourly_time }}</b></p>
                            <img class="rainPic" id="weather-icon" src="/static/Images/raindrop.png" id="weather-icon">
                            <img class="weatherPic" id="weather-icon" src="https://openweathermap.org/img/wn/{{ hour.hourly_symbol }}@2x.png" alt="Weather Icon">
                            <img class="windPic" id="weather-icon" src="{{hour.wind_symbol}}">
                            <p class="hourTemp">{{ hour.hourly_temp }} 째</p>
                            <p class="hourPop">{{hour.hourly_precipitation}} %</p>
                            <p class="hourWind">{{ hour.wind_speed }} mph</p>
                        </div>
                    {% endfor %}
                {% else %}
                    <p>No hourly data available.</p>
                {% endif %}
            </div>
    <div class="top-row">
        <div class="top-symbol">
            <i class="fa-regular fa-calendar-days" style="color: rgba(255, 255, 255, 0.2);"></i>
        </div>
        <div class="top-title">
            <p class="title-top">7-DAY FORECAST</p>
        </div>
    </div>
    <div class="weather-block">
            {% if forecast %}
                {% for fore in forecast %}
                    <div data-bs-toggle="modal" data-bs-target="#modal_{{fore.forecast_day}}" class="forecast-row">
                        <div class="day-box">
                            <p><b>{{ fore.forecast_day }}</b></p>
                        </div>
                        <div class="weather-pic">
                            <img id="weather-icon" src="https://openweathermap.org/img/wn/{{ fore.forecast_symbol }}@2x.png" alt="Weather Icon">
                        </div>
                        <div class="weather-desc">
                            <p>{{ fore.forecast_name }}</p>
                        </div>
                        <div class="weather-temp">
                            <p>{{ fore.forecast_tempmax }}째</p>
                            <p class="tempMin">{{ fore.forecast_tempmin }}째</p>
                        </div>
                    </div>
                    <div id="modal_{{fore.forecast_day}}" class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">{{ fore.forecast_day }}, {{ fore.forecast_date }}</h5>
                            </div>
                            <div class="modal-body">
                                <div class="modal-upper">
                                    <div class="pic-div">
                                        <img id="modal-icon" src="https://openweathermap.org/img/wn/{{ fore.forecast_symbol }}@2x.png" alt="Weather Icon">
                                    </div>
                                    <div class="temps-div">
                                        <p class="temp-max">{{ fore.forecast_tempmax }}째</p>
                                        <p class="temp-min">{{ fore.forecast_tempmin }}째</p>
                                    </div>
                                </div>
                                <div class="modal-elements">
                                    <div class="modal-element">
                                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="gray"><path d="M295-119q-36-1-68.5-18.5T165-189q-40-48-62.5-114.5T80-440q0-83 31.5-156T197-723q54-54 127-85.5T480-840q83 0 156 32t127 87q54 55 85.5 129T880-433q0 77-25 144t-71 113q-28 28-59 42.5T662-119q-18 0-36-4.5T590-137l-56-28q-12-6-25.5-9t-28.5-3q-15 0-28.5 3t-25.5 9l-56 28q-19 10-37.5 14.5T295-119Zm2-80q9 0 18.5-2t18.5-7l56-28q21-11 43.5-16t45.5-5q23 0 46 5t44 16l57 28q9 5 18 7t18 2q19 0 36-10t34-30q32-38 50-91t18-109q0-134-93-227.5T480-760q-134 0-227 94t-93 228q0 57 18.5 111t51.5 91q17 20 33 28.5t34 8.5Zm183-281Zm0 120q33 0 56.5-23.5T560-440q0-8-1.5-16t-4.5-16l50-67q10 13 17.5 27.5T634-480h82q-15-88-81.5-144T480-680q-88 0-155 56.5T244-480h82q14-54 57-87t97-33q17 0 32 3t29 9l-51 69q-2 0-5-.5t-5-.5q-33 0-56.5 23.5T400-440q0 33 23.5 56.5T480-360Z"/></svg>
                                        <p class="element-title">PRESSURE</p>
                                        <p>{{ fore.pressure }} inHg</p>
                                    </div>
                                    <div class="modal-element">
                                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="gray"><path d="M580-240q25 0 42.5-17.5T640-300q0-25-17.5-42.5T580-360q-25 0-42.5 17.5T520-300q0 25 17.5 42.5T580-240Zm-202-2 260-260-56-56-260 260 56 56Zm2-198q25 0 42.5-17.5T440-500q0-25-17.5-42.5T380-560q-25 0-42.5 17.5T320-500q0 25 17.5 42.5T380-440ZM480-80q-137 0-228.5-94T160-408q0-100 79.5-217.5T480-880q161 137 240.5 254.5T800-408q0 140-91.5 234T480-80Zm0-80q104 0 172-70.5T720-408q0-73-60.5-165T480-774Q361-665 300.5-573T240-408q0 107 68 177.5T480-160Zm0-320Z"/></svg>
                                        <p class="element-title">HUMIDITY</p>
                                        <p>{{ fore.humidity }} %</p>
                                    </div>
                                    <div class="modal-element">
                                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="gray"><path d="M198-484q-15 8-30.5 2.5T144-502L44-702q-8-15-2.5-30.5T62-756q15-8 30.5-2.5T116-738l100 200q8 15 2.5 30.5T198-484Zm140 280q-15 8-30.5 2.5T284-222l-80-160q-8-15-2.5-30.5T222-436q15-8 30.5-2.5T276-418l80 160q8 15 2.5 30.5T338-204Zm82-200q-15 8-30.5 2.5T366-422L226-702q-8-15-2.5-30.5T244-756q15-8 30.5-2.5T298-738l140 280q8 15 2.5 30.5T420-404Zm86-200q-15 8-30.5 2.5T452-622l-39-80q-8-15-2.5-30.5T431-756q15-8 30-2.5t23 20.5l40 80q8 15 2.5 30.5T506-604Zm24 399q-15 8-30.5 3T476-222l-40-80q-8-15-2.5-30.5T454-356q15-8 30.5-2.5T508-338l40 80q8 15 2.5 30T530-205Zm186 0q-15 8-30.5 3T662-222L522-502q-8-15-2.5-30.5T540-556q15-8 30.5-2.5T594-538l140 280q8 15 2.5 30T716-205Zm62-239q-15 8-30.5 2.5T724-462L604-702q-8-15-2.5-30.5T622-756q15-8 30.5-2.5T676-738l120 240q8 15 2.5 30.5T778-444Zm120 240q-15 8-30.5 2.5T844-222l-60-120q-8-15-2.5-30.5T802-396q15-8 30.5-2.5T856-378l60 120q8 15 2.5 30.5T898-204Z"/></svg>
                                        <p class="element-title">PRECIPITATION</p>
                                        <p>{{ fore.precipitation }} %</p>
                                    </div>
                                    <div class="modal-element">
                                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="gray"><path d="M558-84q-15 8-30.5 2.5T504-102l-60-120q-8-15-2.5-30.5T462-276q15-8 30.5-2.5T516-258l60 120q8 15 2.5 30.5T558-84Zm240 0q-15 8-30.5 2.5T744-102l-60-120q-8-15-2.5-30.5T702-276q15-8 30.5-2.5T756-258l60 120q8 15 2.5 30.5T798-84Zm-480 0q-15 8-30.5 2.5T264-102l-60-120q-8-15-2.5-30.5T222-276q15-8 30.5-2.5T276-258l60 120q8 15 2.5 30.5T318-84Zm-18-236q-91 0-155.5-64.5T80-540q0-83 55-145t136-73q32-57 87.5-89.5T480-880q90 0 156.5 57.5T717-679q69 6 116 57t47 122q0 75-52.5 127.5T700-320H300Zm0-80h400q42 0 71-29t29-71q0-42-29-71t-71-29h-60v-40q0-66-47-113t-113-47q-48 0-87.5 26T333-704l-10 24h-25q-57 2-97.5 42.5T160-540q0 58 41 99t99 41Zm180-200Z"/></svg>
                                        <p class="element-title">RAINFALL</p>
                                        <p>{{ fore.rainfall }} mm</p>
                                    </div>
                                </div>
                                <div class="daily-summary">
                                    <p>Daily Summary</p>
                                    <div class="daily-description">
                                        <p class="daily-desc"><span>{{ fore.forecast_day }}</span>'s weather will have a low of <span>{{ fore.forecast_tempmin }}째</span> and a high of <span>{{ fore.forecast_tempmax }}째</span> and will consist of <span>{{ fore.forecast_name }}.</span></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <p>No forecast data available</p>
            {% endif %}
    </div>
</div>
{% endblock %}
